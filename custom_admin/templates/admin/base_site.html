{% extends "admin/base_site.html" %}
{% load static i18n %}

{% block extrahead %}
{{ block.super }}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<style>
/* ===== RESET & HIDE DJANGO DEFAULTS ===== */
#nav-sidebar,
#toggle-nav-sidebar,
nav.sticky,
aside#nav-sidebar {
    display: none !important;
}

.main.shifted,
#main.shifted,
.shifted,
main.shifted {
    margin-left: 0 !important;
    padding-left: 0 !important;
}

/* ===== VARIABLES ===== */
:root {
    --primary: #6366f1;
    --primary-dark: #4f46e5;
    --primary-light: #818cf8;
    --success: #10b981;
    --success-dark: #059669;
    --warning: #f59e0b;
    --danger: #ef4444;
    --sidebar-bg: #1e293b;
    --sidebar-width: 220px;
    --gray-50: #f8fafc;
    --gray-100: #f1f5f9;
    --gray-200: #e2e8f0;
    --gray-300: #cbd5e1;
    --gray-400: #94a3b8;
    --gray-500: #64748b;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-800: #1e293b;
    --radius: 8px;
}

/* ===== GLOBAL ===== */
* {
    box-sizing: border-box;
}

html, body {
    margin: 0 !important;
    padding: 0 !important;
    overflow-x: hidden !important;
    background: #f4f6f9 !important;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
    color: var(--gray-700) !important;
    line-height: 1.5 !important;
}

/* ===== SIDEBAR ===== */
#kaagjee-sidebar {
    width: var(--sidebar-width);
    background: var(--sidebar-bg);
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    z-index: 99999;
    overflow-y: auto;
    overflow-x: hidden;
}

#kaagjee-sidebar::-webkit-scrollbar {
    width: 6px;
}

#kaagjee-sidebar::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.2);
    border-radius: 3px;
}

#kaagjee-sidebar .sb-header {
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 1px solid rgba(255,255,255,0.08);
}

#kaagjee-sidebar .sb-header .logo {
    font-size: 24px;
}

#kaagjee-sidebar .sb-header .title {
    color: white;
    font-size: 18px;
    font-weight: 700;
}

#kaagjee-sidebar .sb-nav {
    padding: 15px 0;
}

#kaagjee-sidebar .sb-section {
    margin-bottom: 5px;
}

#kaagjee-sidebar .sb-section-title {
    color: #ffffff !important;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    padding: 12px 20px 8px;
    letter-spacing: 0.8px;
}

#kaagjee-sidebar .sb-link {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--gray-400);
    text-decoration: none;
    padding: 10px 20px;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.2s;
    border-left: 3px solid transparent;
    margin: 2px 0;
}

#kaagjee-sidebar .sb-link:hover {
    background: rgba(255,255,255,0.05);
    color: white;
    border-left-color: var(--primary-light);
}

#kaagjee-sidebar .sb-link.active {
    background: rgba(99, 102, 241, 0.15);
    color: white;
    border-left-color: var(--primary);
}

#kaagjee-sidebar .sb-footer {
    padding: 20px;
    border-top: 1px solid rgba(255,255,255,0.08);
    position: sticky;
    bottom: 0;
    background: var(--sidebar-bg);
}

#kaagjee-sidebar .sb-logout {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--gray-400);
    padding: 12px;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    font-family: inherit;
    transition: all 0.2s;
}

#kaagjee-sidebar .sb-logout:hover {
    background: rgba(239, 68, 68, 0.15);
    border-color: rgba(239, 68, 68, 0.3);
    color: #fca5a5;
}

/* ===== MAIN LAYOUT ===== */
body.kaagjee-admin #container {
    margin-left: var(--sidebar-width) !important;
    min-height: 100vh !important;
    background: #f4f6f9 !important;
    min-width: 0 !important;
    width: calc(100% - var(--sidebar-width)) !important;
    overflow-x: visible !important;
}

/* ===== HEADER ===== */
body.kaagjee-admin #header {
    /* margin-left: var(--sidebar-width) !important; */
    background: white !important;
    /* padding: 0 24px !important; */
    height: 60px !important;
    display: flex !important;
    align-items: center !important;
    /* justify-content: flex-end !important; */
    border-bottom: 1px solid var(--gray-200) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 100 !important;
}

body.kaagjee-admin #branding {
    display: none !important;
}

body.kaagjee-admin #user-tools {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    font-size: 13px !important;
    color: var(--gray-600) !important;
    margin: 0 !important;
    padding: 0 !important;
    float: none !important;
}

body.kaagjee-admin #user-tools a {
    color: var(--gray-600) !important;
    text-decoration: none !important;
    padding: 6px 12px !important;
    border-radius: 6px !important;
    transition: all 0.15s !important;
}

body.kaagjee-admin #user-tools a:hover {
    background: var(--gray-100) !important;
    color: var(--primary) !important;
}

/* Logout button in header */
body.kaagjee-admin #user-tools a[href*="logout"],
body.kaagjee-admin #user-tools form button {
    background: var(--primary) !important;
    color: white !important;
    padding: 8px 16px !important;
    border-radius: 6px !important;
    font-weight: 500 !important;
    border: none !important;
    cursor: pointer !important;
}

body.kaagjee-admin #user-tools a[href*="logout"]:hover {
    background: var(--primary-dark) !important;
}

/* ===== BREADCRUMBS ===== */
body.kaagjee-admin div.breadcrumbs {
    background: var(--primary) !important;
    padding: 14px 24px !important;
    /* margin-left: var(--sidebar-width) !important; */
    color: white !important;
    font-size: 13px !important;
    font-weight: 500 !important;
}

body.kaagjee-admin div.breadcrumbs a {
    color: rgba(255,255,255,0.8) !important;
    text-decoration: none !important;
}

body.kaagjee-admin div.breadcrumbs a:hover {
    color: white !important;
}

/* ===== CONTENT ===== */
body.kaagjee-admin #content {
    padding: 24px !important;
    max-width: none !important;
    overflow-x: visible !important;
}

body.kaagjee-admin #content > h1 {
    font-size: 24px !important;
    font-weight: 700 !important;
    color: var(--gray-800) !important;
    margin: 0 0 24px 0 !important;
    padding: 0 !important;
    background: none !important;
}

/* ===== MODULES & FIELDSETS ===== */
.module,
fieldset,
body.kaagjee-admin .module,
body.kaagjee-admin fieldset {
    background: white !important;
    border: none !important;
    border-radius: var(--radius) !important;
    margin-bottom: 20px !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
    overflow: hidden !important;
}

.module h2,
.module caption,
fieldset h2,
fieldset legend,
body.kaagjee-admin .module h2,
body.kaagjee-admin .module caption,
body.kaagjee-admin fieldset h2 {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark)) !important;
    color: white !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    padding: 14px 20px !important;
    margin: 0 !important;
    border: none !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
}

/* ===== FORM ROWS ===== */
.form-row,
body.kaagjee-admin .form-row {
    padding: 16px 20px !important;
    border-bottom: 1px solid var(--gray-100) !important;
    background: white !important;
}

.form-row:last-child {
    border-bottom: none !important;
}

.form-row > label {
    font-weight: 600 !important;
    color: var(--gray-700) !important;
    font-size: 13px !important;
    margin-bottom: 8px !important;
    display: block !important;
}

.form-row .help {
    font-size: 12px !important;
    color: var(--gray-500) !important;
    margin-top: 6px !important;
}

/* ===== INPUTS ===== */
input[type="text"],
input[type="password"],
input[type="email"],
input[type="number"],
input[type="url"],
input[type="tel"],
input[type="date"],
textarea,
select {
    width: 100% !important;
    max-width: 500px !important;
    /* padding: 10px 14px !important; */
    border: 2px solid var(--gray-200) !important;
    border-radius: var(--radius) !important;
    font-size: 14px !important;
    font-family: inherit !important;
    color: var(--gray-800) !important;
    background: white !important;
    transition: all 0.2s !important;
}

input:focus,
textarea:focus,
select:focus {
    outline: none !important;
    border-color: var(--primary) !important;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1) !important;
}

textarea {
    min-height: 120px !important;
    resize: vertical !important;
}

select[multiple] {
    min-height: 150px !important;
}

/* ===== BUTTONS ===== */
input[type="submit"],
button[type="submit"],
.submit-row input,
.button,
a.button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 10px 20px !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    font-family: inherit !important;
    border: none !important;
    border-radius: var(--radius) !important;
    cursor: pointer !important;
    transition: all 0.2s !important;
    text-decoration: none !important;
    background: var(--primary) !important;
    color: white !important;
}

input[type="submit"]:hover,
.button:hover {
    background: var(--primary-dark) !important;
    transform: translateY(-1px) !important;
}

input[name="_save"],
.default {
    background: var(--success) !important;
}

input[name="_save"]:hover {
    background: var(--success-dark) !important;
}

.deletelink {
    background: var(--danger) !important;
    color: white !important;
}

.submit-row {
    background: var(--gray-50) !important;
    padding: 16px 20px !important;
    border-top: 1px solid var(--gray-200) !important;
    margin: 0 !important;
    display: flex !important;
    gap: 10px !important;
    flex-wrap: wrap !important;
}

/* ===== OBJECT TOOLS ===== */
.object-tools {
    margin: 0 !important;
    padding: 0 !important;
}

.object-tools a {
    background: var(--success) !important;
    color: white !important;
    padding: 10px 16px !important;
    border-radius: var(--radius) !important;
    text-decoration: none !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    display: inline-flex !important;
    align-items: center !important;
    gap: 6px !important;
}

.object-tools a:hover {
    background: var(--success-dark) !important;
}

/* ===== TABLES ===== */
#result_list,
#changelist table,
table {
    width: 100% !important;
    background: white !important;
    border: none !important;
    border-radius: var(--radius) !important;
    border-collapse: separate !important;
    border-spacing: 0 !important;
    overflow: visible !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
}

.results {
    overflow-x: auto !important;
    width: 100% !important;
}

#result_list th,
#changelist table th,
table th {
    background: var(--gray-50) !important;
    color: var(--gray-600) !important;
    font-weight: 600 !important;
    font-size: 11px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    padding: 14px 16px !important;
    text-align: left !important;
    border-bottom: 2px solid var(--gray-200) !important;
}

#result_list td,
#changelist table td,
table td {
    padding: 14px 16px !important;
    border-bottom: 1px solid var(--gray-100) !important;
    font-size: 14px !important;
    color: var(--gray-700) !important;
    vertical-align: middle !important;
}

#result_list tr:hover,
#changelist table tr:hover {
    background: var(--gray-50) !important;
}

table a {
    color: var(--primary) !important;
    text-decoration: none !important;
    font-weight: 500 !important;
}

table a:hover {
    text-decoration: underline !important;
}

/* ===== CHANGELIST ===== */
#changelist {
    background: transparent !important;
    display: flex !important;
    gap: 20px !important;
    align-items: flex-start !important;
    flex-direction: row-reverse !important;
}

#changelist .changelist-form-container {
    flex: 1 !important;
    min-width: 0 !important;
    overflow-x: auto !important;
    order: 2 !important;
}

#changelist #toolbar {
    background: white !important;
    padding: 16px 20px !important;
    border-radius: var(--radius) !important;
    margin-bottom: 16px !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
    display: flex !important;
    align-items: stretch !important;
    gap: 0 !important;
    justify-content: flex-start !important;
}

#changelist #toolbar .toolbar-left {
    display: flex !important;
    align-items: stretch !important;
    gap: 0 !important;
    flex: 1 !important;
    max-width: 500px !important;
}

#changelist #toolbar .toolbar-right {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
    margin-left: auto !important;
}

/* #changelist #searchbar {
    flex: 1 !important;
    max-width: 400px !important;
    padding: 10px 14px !important;
    border: 2px solid var(--gray-200) !important;
    font-size: 14px !important;
} */

/* #changelist-search {
    display: flex !important;
    align-items: stretch !important;
    flex: 1 !important;
    max-width: 500px !important;
    height: 44px !important;
} */

/* #changelist-search #searchbar {
    border-radius: var(--radius) 0 0 var(--radius) !important;
    border-right: none !important;
    flex: 1 !important;
    max-width: none !important;
    height: 44px !important;
    padding: 10px 14px !important;
    border: 2px solid var(--gray-200) !important;
    font-size: 14px !important;
    box-sizing: border-box !important;
}

#changelist-search [type="submit"],
#changelist-search [value="Search"] {
    border-radius: 0 var(--radius) var(--radius) 0 !important;
    padding: 0 20px !important;
    border: 2px solid var(--primary) !important;
    border-left: none !important;
    background: var(--primary) !important;
    color: white !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s !important;
    height: 44px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

#changelist-search [type="submit"]:hover {
    background: var(--primary-dark) !important;
    border-color: var(--primary-dark) !important;
} */

/* Filter Sidebar */
/* #changelist-filter {
    background: white !important;
    border-radius: var(--radius) !important;
    padding: 20px !important;
    width: 200px !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
    position: sticky !important;
    top: 80px !important;
    order: 1 !important;
    flex-shrink: 0 !important;
} */

/* Changelist wrapper for responsive layout */
#changelist .results {
    display: flex !important;
    gap: 20px !important;
    align-items: flex-start !important;
}

#changelist .results > * {
    flex: 1 !important;
}

#changelist .results #changelist-filter {
    flex: 0 0 200px !important;
}

#changelist-filter h2 {
    font-size: 14px !important;
    font-weight: 700 !important;
    color: var(--gray-800) !important;
    margin: 0 0 16px 0 !important;
    padding: 0 0 12px !important;
    background: none !important;
    border-bottom: 2px solid var(--gray-200) !important;
    text-transform: none !important;
}

#changelist-filter h3 {
    font-size: 11px !important;
    font-weight: 600 !important;
    color: var(--gray-500) !important;
    text-transform: uppercase !important;
    margin: 20px 0 10px !important;
    letter-spacing: 0.5px !important;
}

#changelist-filter ul {
    margin: 0 !important;
    padding: 0 !important;
    list-style: none !important;
}

#changelist-filter li {
    margin: 0 !important;
}

#changelist-filter a {
    display: block !important;
    padding: 8px 12px !important;
    color: var(--gray-600) !important;
    text-decoration: none !important;
    font-size: 13px !important;
    border-radius: 6px !important;
    transition: all 0.15s !important;
}

#changelist-filter a:hover {
    background: var(--gray-100) !important;
    color: var(--primary) !important;
}

#changelist-filter li.selected a {
    background: var(--primary) !important;
    color: white !important;
}

/* ===== ACTIONS ===== */
.actions {
    background: white !important;
    padding: 14px 16px !important;
    border-radius: var(--radius) !important;
    margin-bottom: 16px !important;
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
}

.actions label {
    font-weight: 500 !important;
    color: var(--gray-600) !important;
    font-size: 13px !important;
}

.actions select {
    max-width: 280px !important;
}

.actions button {
    padding: 10px 16px !important;
}

/* ===== PAGINATION ===== */
.paginator {
    background: white !important;
    padding: 14px 20px !important;
    border-radius: var(--radius) !important;
    margin-top: 16px !important;
    font-size: 13px !important;
    color: var(--gray-600) !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05) !important;
}

.paginator a {
    color: var(--primary) !important;
    text-decoration: none !important;
    padding: 6px 12px !important;
    border-radius: 6px !important;
    font-weight: 500 !important;
}

.paginator a:hover {
    background: var(--gray-100) !important;
}

/* ===== MESSAGES ===== */
.messagelist {
    padding: 0 !important;
    margin: 0 0 20px 0 !important;
}

.messagelist li {
    padding: 14px 20px !important;
    border-radius: var(--radius) !important;
    margin-bottom: 10px !important;
    font-size: 14px !important;
    font-weight: 500 !important;
}

.messagelist .success {
    background: #ecfdf5 !important;
    color: #065f46 !important;
    border-left: 4px solid var(--success) !important;
}

.messagelist .warning {
    background: #fffbeb !important;
    color: #92400e !important;
    border-left: 4px solid var(--warning) !important;
}

.messagelist .error {
    background: #fef2f2 !important;
    color: #991b1b !important;
    border-left: 4px solid var(--danger) !important;
}

/* ===== ERRORS ===== */
.errorlist {
    color: var(--danger) !important;
    font-size: 13px !important;
    margin: 6px 0 0 !important;
    padding: 0 !important;
    list-style: none !important;
}

.errornote {
    background: #fef2f2 !important;
    color: #991b1b !important;
    padding: 14px 20px !important;
    border-radius: var(--radius) !important;
    margin-bottom: 20px !important;
    border-left: 4px solid var(--danger) !important;
}

/* ===== DASHBOARD ===== */
.dashboard #content-main {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
    gap: 20px !important;
}

/* ===== LINKS ===== */
.addlink {
    color: var(--success) !important;
    font-weight: 600 !important;
}

.changelink {
    color: var(--primary) !important;
}

/* ===== RELATED WIDGET ===== */
.related-widget-wrapper {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
}

.related-widget-wrapper select {
    flex: 1 !important;
}

/* ===== STATUS BADGES ===== */
img[src*="icon-yes"],
img[src*="icon-no"] {
    display: none !important;
}

/* ===== FILE INPUT ===== */
input[type="file"] {
    padding: 10px !important;
    border: 2px dashed var(--gray-300) !important;
    border-radius: var(--radius) !important;
    background: var(--gray-50) !important;
    cursor: pointer !important;
}

input[type="file"]:hover {
    border-color: var(--primary) !important;
}

/* ===== INLINE FORMS ===== */
.inline-group {
    margin-bottom: 20px !important;
}

.inline-related {
    background: var(--gray-50) !important;
    border-radius: var(--radius) !important;
    margin-bottom: 10px !important;
    padding: 16px !important;
    border: 1px solid var(--gray-200) !important;
}

.inline-related h3 {
    margin: 0 0 12px 0 !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    background: none !important;
    padding: 0 !important;
    color: var(--gray-700) !important;
}

/* ===== MOBILE TOGGLE ===== */
#kaagjee-toggle {
    display: none;
    position: fixed;
    top: 12px;
    left: 12px;
    z-index: 999999;
    background: var(--primary);
    color: white;
    border: none;
    width: 44px;
    height: 44px;
    border-radius: var(--radius);
    cursor: pointer;
    font-size: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

@media (max-width: 1024px) {
    #kaagjee-sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s;
    }
    #kaagjee-sidebar.open {
        transform: translateX(0);
    }
    body.kaagjee-admin #container,
    body.kaagjee-admin #header,
    body.kaagjee-admin div.breadcrumbs {
        margin-left: 0 !important;
        min-width: 0 !important;
        width: 100% !important;
    }
    #kaagjee-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Content responsive adjustments */
    body.kaagjee-admin #content {
        padding: 16px !important;
    }
    
    /* Changelist responsive */
    #changelist {
        flex-direction: column !important;
    }
    
    #changelist-filter {
        width: 100% !important;
        position: static !important;
        order: -1 !important;
        margin-bottom: 16px !important;
    }
    
    /* Table responsive */
    #result_list,
    #changelist table,
    table {
        overflow-x: auto !important;
        display: block !important;
        white-space: nowrap !important;
    }
    
    /* Toolbar responsive */
    #changelist #toolbar {
        flex-direction: column !important;
        align-items: stretch !important;
    }
    
    #changelist #searchbar {
        max-width: none !important;
    }
}
</style>
{% endblock %}

{% block userlinks %}
{{ block.super }}
<script>
(function() {
    'use strict';
    
    if (document.body.classList.contains('login')) return;
    
    function initSidebar() {
        if (document.getElementById('kaagjee-sidebar')) return;
        
        // Remove Django defaults
        ['nav-sidebar', 'toggle-nav-sidebar'].forEach(function(id) {
            var el = document.getElementById(id);
            if (el) el.parentNode.removeChild(el);
        });
        
        document.querySelectorAll('.shifted').forEach(function(el) {
            el.classList.remove('shifted');
        });
        
        var csrfInput = document.querySelector('[name=csrfmiddlewaretoken]');
        var csrfToken = csrfInput ? csrfInput.value : '';
        var currentPath = window.location.pathname;
        
        var sidebar = document.createElement('div');
        sidebar.id = 'kaagjee-sidebar';
        
        var html = '<div class="sb-header"><span class="logo">‚ö°</span><span class="title">Kaagjee</span></div>';
        html += '<div class="sb-nav">';
        html += '<div class="sb-section"><a href="/admin/" class="sb-link' + (currentPath === '/admin/' ? ' active' : '') + '"><span>üìä</span> Dashboard</a></div>';
        
        var apps = [
            {title: 'ACCOUNTS', links: [{name: 'üë§ Users', url: '/admin/accounts/user/'}, {name: 'üìç Addresses', url: '/admin/accounts/address/'}]},
            {title: 'PRODUCTS', links: [{name: 'üì¶ Products', url: '/admin/products/product/'}]},
            {title: 'CATEGORIES', links: [{name: 'üìÅ Categories', url: '/admin/categories/category/'}, {name: 'üìÇ Subcategories', url: '/admin/categories/subcategory/'}]},
            {title: 'LOCATIONS', links: [{name: 'üó∫Ô∏è States', url: '/admin/locations/state/'}, {name: 'üèôÔ∏è Cities', url: '/admin/locations/city/'}]},
            {title: 'ORDERS', links: [{name: 'üõí Orders', url: '/admin/orders/order/'}, {name: 'üìù Submissions', url: '/admin/orders/formsubmission/'}]},
            {title: 'BLOG', links: [{name: 'üì∞ Posts', url: '/admin/blog/blogpost/'}, {name: 'üè∑Ô∏è Categories', url: '/admin/blog/blogcategory/'}, {name: 'üîñ Tags', url: '/admin/blog/blogtag/'}]},
            {title: 'BANNER', links: [{name: 'üñºÔ∏è Banners', url: '/admin/banner/banner/'}]},
            {title: 'AUTH', links: [{name: 'üë• Groups', url: '/admin/auth/group/'}]}
        ];
        
        apps.forEach(function(app) {
            html += '<div class="sb-section"><div class="sb-section-title">' + app.title + '</div>';
            app.links.forEach(function(link) {
                var isActive = currentPath.indexOf(link.url) === 0;
                html += '<a href="' + link.url + '" class="sb-link' + (isActive ? ' active' : '') + '">' + link.name + '</a>';
            });
            html += '</div>';
        });
        
        html += '</div>';
        html += '<div class="sb-footer"><form method="post" action="/admin/logout/" style="margin:0;"><input type="hidden" name="csrfmiddlewaretoken" value="' + csrfToken + '"><button type="submit" class="sb-logout">üö™ Logout</button></form></div>';
        
        sidebar.innerHTML = html;
        document.body.insertBefore(sidebar, document.body.firstChild);
        
        var toggle = document.createElement('button');
        toggle.id = 'kaagjee-toggle';
        toggle.innerHTML = '‚ò∞';
        toggle.onclick = function() { sidebar.classList.toggle('open'); };
        document.body.appendChild(toggle);
        
        document.body.classList.add('kaagjee-admin');
        
        // Move add button to toolbar
        setTimeout(function() {
            var toolbar = document.querySelector('#changelist #toolbar');
            var objectTools = document.querySelector('.object-tools');
            if (toolbar && objectTools) {
                // Wrap existing toolbar content
                var toolbarContent = toolbar.innerHTML;
                toolbar.innerHTML = '<div class="toolbar-left">' + toolbarContent + '</div><div class="toolbar-right"></div>';
                
                // Move object tools to toolbar right
                var toolbarRight = toolbar.querySelector('.toolbar-right');
                toolbarRight.appendChild(objectTools);
            }
        }, 100);
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initSidebar);
    } else {
        initSidebar();
    }
    window.addEventListener('load', initSidebar);
})();
</script>
{% endblock %}
